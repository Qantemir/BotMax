2025-05-19 23:20:46,359 - __main__ - INFO - Starting bot...
2025-05-19 23:20:46,384 - aiogram.dispatcher - INFO - Start polling
2025-05-19 23:20:46,965 - aiogram.dispatcher - INFO - Run polling for bot @maksos_shop_bot id=7685552550 - 'MaxBOT'
2025-05-19 23:20:47,110 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:20:47,111 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7685552550)
2025-05-19 23:20:51,269 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:20:51,269 - aiogram.dispatcher - WARNING - Sleep for 1.256650 seconds and try again... (tryings = 1, bot id = 7685552550)
2025-05-19 23:20:52,700 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:20:52,700 - aiogram.dispatcher - WARNING - Sleep for 1.797557 seconds and try again... (tryings = 2, bot id = 7685552550)
2025-05-19 23:20:57,662 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:20:57,663 - aiogram.dispatcher - WARNING - Sleep for 2.191069 seconds and try again... (tryings = 3, bot id = 7685552550)
2025-05-19 23:21:00,004 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:00,005 - aiogram.dispatcher - WARNING - Sleep for 3.037997 seconds and try again... (tryings = 4, bot id = 7685552550)
2025-05-19 23:21:03,203 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:03,204 - aiogram.dispatcher - WARNING - Sleep for 3.990433 seconds and try again... (tryings = 5, bot id = 7685552550)
2025-05-19 23:21:07,369 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:07,369 - aiogram.dispatcher - WARNING - Sleep for 4.990100 seconds and try again... (tryings = 6, bot id = 7685552550)
2025-05-19 23:21:12,519 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:12,519 - aiogram.dispatcher - WARNING - Sleep for 4.978665 seconds and try again... (tryings = 7, bot id = 7685552550)
2025-05-19 23:21:17,644 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:17,644 - aiogram.dispatcher - WARNING - Sleep for 5.002681 seconds and try again... (tryings = 8, bot id = 7685552550)
2025-05-19 23:21:22,785 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:22,786 - aiogram.dispatcher - WARNING - Sleep for 5.051300 seconds and try again... (tryings = 9, bot id = 7685552550)
2025-05-19 23:21:28,009 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:28,010 - aiogram.dispatcher - WARNING - Sleep for 5.081287 seconds and try again... (tryings = 10, bot id = 7685552550)
2025-05-19 23:21:33,242 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:33,243 - aiogram.dispatcher - WARNING - Sleep for 4.985537 seconds and try again... (tryings = 11, bot id = 7685552550)
2025-05-19 23:21:38,382 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:38,383 - aiogram.dispatcher - WARNING - Sleep for 5.049221 seconds and try again... (tryings = 12, bot id = 7685552550)
2025-05-19 23:21:43,604 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:43,604 - aiogram.dispatcher - WARNING - Sleep for 5.033181 seconds and try again... (tryings = 13, bot id = 7685552550)
2025-05-19 23:21:48,802 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:48,803 - aiogram.dispatcher - WARNING - Sleep for 5.085199 seconds and try again... (tryings = 14, bot id = 7685552550)
2025-05-19 23:21:54,038 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:54,039 - aiogram.dispatcher - WARNING - Sleep for 4.971217 seconds and try again... (tryings = 15, bot id = 7685552550)
2025-05-19 23:21:59,162 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:21:59,163 - aiogram.dispatcher - WARNING - Sleep for 4.872467 seconds and try again... (tryings = 16, bot id = 7685552550)
2025-05-19 23:22:04,204 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:22:04,204 - aiogram.dispatcher - WARNING - Sleep for 5.128067 seconds and try again... (tryings = 17, bot id = 7685552550)
2025-05-19 23:22:09,489 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:22:09,490 - aiogram.dispatcher - WARNING - Sleep for 5.043207 seconds and try again... (tryings = 18, bot id = 7685552550)
2025-05-19 23:22:14,714 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:22:14,715 - aiogram.dispatcher - WARNING - Sleep for 4.991006 seconds and try again... (tryings = 19, bot id = 7685552550)
2025-05-19 23:22:19,853 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:22:19,853 - aiogram.dispatcher - WARNING - Sleep for 4.963246 seconds and try again... (tryings = 20, bot id = 7685552550)
2025-05-19 23:22:24,978 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:22:24,979 - aiogram.dispatcher - WARNING - Sleep for 4.784349 seconds and try again... (tryings = 21, bot id = 7685552550)
2025-05-19 23:22:29,921 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:22:29,922 - aiogram.dispatcher - WARNING - Sleep for 5.204404 seconds and try again... (tryings = 22, bot id = 7685552550)
2025-05-19 23:22:35,338 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:22:35,338 - aiogram.dispatcher - WARNING - Sleep for 5.046888 seconds and try again... (tryings = 23, bot id = 7685552550)
2025-05-19 23:22:40,544 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:22:40,545 - aiogram.dispatcher - WARNING - Sleep for 5.151827 seconds and try again... (tryings = 24, bot id = 7685552550)
2025-05-19 23:22:45,860 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:22:45,861 - aiogram.dispatcher - WARNING - Sleep for 5.080117 seconds and try again... (tryings = 25, bot id = 7685552550)
2025-05-19 23:22:51,087 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:22:51,088 - aiogram.dispatcher - WARNING - Sleep for 4.927315 seconds and try again... (tryings = 26, bot id = 7685552550)
2025-05-19 23:22:56,190 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:22:56,190 - aiogram.dispatcher - WARNING - Sleep for 5.119893 seconds and try again... (tryings = 27, bot id = 7685552550)
2025-05-19 23:23:01,452 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:23:01,453 - aiogram.dispatcher - WARNING - Sleep for 4.972265 seconds and try again... (tryings = 28, bot id = 7685552550)
2025-05-19 23:23:06,578 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:23:06,579 - aiogram.dispatcher - WARNING - Sleep for 4.922351 seconds and try again... (tryings = 29, bot id = 7685552550)
2025-05-19 23:23:11,661 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:23:11,662 - aiogram.dispatcher - WARNING - Sleep for 4.997566 seconds and try again... (tryings = 30, bot id = 7685552550)
2025-05-19 23:23:16,818 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:23:16,818 - aiogram.dispatcher - WARNING - Sleep for 5.036821 seconds and try again... (tryings = 31, bot id = 7685552550)
2025-05-19 23:23:22,013 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:23:22,014 - aiogram.dispatcher - WARNING - Sleep for 4.964089 seconds and try again... (tryings = 32, bot id = 7685552550)
2025-05-19 23:23:27,180 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first
2025-05-19 23:23:27,181 - aiogram.dispatcher - WARNING - Sleep for 5.072457 seconds and try again... (tryings = 33, bot id = 7685552550)
2025-05-19 23:23:28,397 - aiogram.dispatcher - INFO - Polling stopped
2025-05-19 23:23:28,661 - aiogram.dispatcher - INFO - Polling stopped for bot @maksos_shop_bot id=7685552550 - 'MaxBOT'
2025-05-19 23:23:28,663 - root - INFO - Bot stopped
2025-05-19 23:23:35,431 - __main__ - INFO - Starting bot...
2025-05-19 23:23:35,432 - aiogram.dispatcher - INFO - Start polling
2025-05-19 23:23:38,753 - aiogram.dispatcher - INFO - Run polling for bot @platform_shop_bot id=7573060547 - 'Platform_shop_bot'
2025-05-19 23:23:42,316 - database.mongodb - INFO - Attempting to connect to MongoDB at 
2025-05-19 23:23:42,317 - database.mongodb - ERROR - Unexpected error connecting to MongoDB: Empty host (or extra comma in host list)
2025-05-19 23:23:42,318 - database.mongodb - ERROR - Error getting sleep mode: Empty host (or extra comma in host list)
2025-05-19 23:23:42,751 - aiogram.event - INFO - Update id=102964010 is handled. Duration 435 ms by bot id=7573060547
2025-05-19 23:23:45,483 - database.mongodb - INFO - Attempting to connect to MongoDB at 
2025-05-19 23:23:45,484 - database.mongodb - ERROR - Unexpected error connecting to MongoDB: Empty host (or extra comma in host list)
2025-05-19 23:23:45,484 - database.mongodb - ERROR - Error getting sleep mode: Empty host (or extra comma in host list)
2025-05-19 23:23:45,680 - aiogram.event - INFO - Update id=102964011 is handled. Duration 213 ms by bot id=7573060547
2025-05-19 23:23:49,723 - database.mongodb - INFO - [DEBUG] Getting products for category: Тестовая категория
2025-05-19 23:23:49,723 - database.mongodb - ERROR - [ERROR] Error getting products for category Тестовая категория: 'NoneType' object has no attribute 'products'
2025-05-19 23:23:49,886 - aiogram.event - INFO - Update id=102964012 is handled. Duration 164 ms by bot id=7573060547
2025-05-19 23:23:58,467 - aiogram.event - INFO - Update id=102964013 is handled. Duration 175 ms by bot id=7573060547
2025-05-19 23:24:03,217 - handlers.admin_handlers - INFO - Successful admin login for user 531632690
2025-05-19 23:24:03,407 - aiogram.event - INFO - Update id=102964014 is handled. Duration 209 ms by bot id=7573060547
2025-05-19 23:24:05,415 - aiogram.event - INFO - Update id=102964015 is handled. Duration 187 ms by bot id=7573060547
2025-05-19 23:24:08,841 - aiogram.event - INFO - Update id=102964016 is handled. Duration 267 ms by bot id=7573060547
2025-05-19 23:24:12,240 - aiogram.event - INFO - Update id=102964017 is handled. Duration 355 ms by bot id=7573060547
2025-05-19 23:24:14,167 - aiogram.event - INFO - Update id=102964018 is handled. Duration 312 ms by bot id=7573060547
2025-05-19 23:24:16,909 - aiogram.event - INFO - Update id=102964019 is handled. Duration 167 ms by bot id=7573060547
2025-05-19 23:24:20,921 - aiogram.event - INFO - Update id=102964020 is handled. Duration 249 ms by bot id=7573060547
2025-05-19 23:24:24,179 - aiogram.event - INFO - Update id=102964021 is handled. Duration 169 ms by bot id=7573060547
2025-05-19 23:24:29,013 - database.mongodb - ERROR - Error adding product: 'NoneType' object has no attribute 'products'
2025-05-19 23:24:29,199 - aiogram.event - INFO - Update id=102964022 is handled. Duration 190 ms by bot id=7573060547
2025-05-19 23:24:30,945 - aiogram.event - INFO - Update id=102964023 is not handled. Duration 6 ms by bot id=7573060547
2025-05-19 23:24:30,946 - aiogram.event - ERROR - Cause exception while process update id=102964023 by bot id=7573060547
AttributeError: 'NoneType' object has no attribute 'products'
Traceback (most recent call last):
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 72, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 199, in list_products
    products = await db.get_all_products()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\database\mongodb.py", line 227, in get_all_products
    cursor = self.db.products.find()
             ^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'products'
2025-05-19 23:24:34,979 - aiogram.event - INFO - Update id=102964024 is not handled. Duration 5 ms by bot id=7573060547
2025-05-19 23:24:34,981 - aiogram.event - ERROR - Cause exception while process update id=102964024 by bot id=7573060547
AttributeError: 'NoneType' object has no attribute 'products'
Traceback (most recent call last):
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 72, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 199, in list_products
    products = await db.get_all_products()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\database\mongodb.py", line 227, in get_all_products
    cursor = self.db.products.find()
             ^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'products'
2025-05-19 23:24:35,887 - aiogram.event - INFO - Update id=102964025 is not handled. Duration 7 ms by bot id=7573060547
2025-05-19 23:24:35,887 - aiogram.event - ERROR - Cause exception while process update id=102964025 by bot id=7573060547
AttributeError: 'NoneType' object has no attribute 'products'
Traceback (most recent call last):
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 72, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 199, in list_products
    products = await db.get_all_products()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\database\mongodb.py", line 227, in get_all_products
    cursor = self.db.products.find()
             ^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'products'
2025-05-19 23:24:36,927 - aiogram.event - INFO - Update id=102964026 is not handled. Duration 5 ms by bot id=7573060547
2025-05-19 23:24:36,927 - aiogram.event - ERROR - Cause exception while process update id=102964026 by bot id=7573060547
AttributeError: 'NoneType' object has no attribute 'products'
Traceback (most recent call last):
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 72, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 199, in list_products
    products = await db.get_all_products()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\database\mongodb.py", line 227, in get_all_products
    cursor = self.db.products.find()
             ^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'products'
2025-05-19 23:24:37,635 - aiogram.event - INFO - Update id=102964027 is not handled. Duration 9 ms by bot id=7573060547
2025-05-19 23:24:37,636 - aiogram.event - ERROR - Cause exception while process update id=102964027 by bot id=7573060547
AttributeError: 'NoneType' object has no attribute 'products'
Traceback (most recent call last):
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 72, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 199, in list_products
    products = await db.get_all_products()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\database\mongodb.py", line 227, in get_all_products
    cursor = self.db.products.find()
             ^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'products'
2025-05-19 23:24:39,590 - database.mongodb - ERROR - [ERROR] Failed to delete old orders: 'NoneType' object has no attribute 'orders'
2025-05-19 23:24:39,770 - aiogram.event - INFO - Update id=102964028 is handled. Duration 184 ms by bot id=7573060547
2025-05-19 23:24:45,097 - aiogram.event - INFO - Update id=102964029 is not handled. Duration 6 ms by bot id=7573060547
2025-05-19 23:24:45,097 - aiogram.event - ERROR - Cause exception while process update id=102964029 by bot id=7573060547
AttributeError: 'NoneType' object has no attribute 'products'
Traceback (most recent call last):
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 72, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 199, in list_products
    products = await db.get_all_products()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\database\mongodb.py", line 227, in get_all_products
    cursor = self.db.products.find()
             ^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'products'
2025-05-19 23:24:46,120 - aiogram.event - INFO - Update id=102964030 is not handled. Duration 6 ms by bot id=7573060547
2025-05-19 23:24:46,120 - aiogram.event - ERROR - Cause exception while process update id=102964030 by bot id=7573060547
AttributeError: 'NoneType' object has no attribute 'products'
Traceback (most recent call last):
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 72, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 247, in edit_products_list
    products = await db.get_all_products()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\database\mongodb.py", line 227, in get_all_products
    cursor = self.db.products.find()
             ^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'products'
2025-05-19 23:24:48,428 - aiogram.event - INFO - Update id=102964031 is not handled. Duration 6 ms by bot id=7573060547
2025-05-19 23:24:48,429 - aiogram.event - ERROR - Cause exception while process update id=102964031 by bot id=7573060547
AttributeError: 'NoneType' object has no attribute 'products'
Traceback (most recent call last):
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 72, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\handlers\admin_handlers.py", line 275, in delete_product_list
    products = await db.get_all_products()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\r-keeper\Desktop\BotMax\database\mongodb.py", line 227, in get_all_products
    cursor = self.db.products.find()
             ^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'products'
2025-05-19 23:28:07,073 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-05-19 23:28:07,073 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7573060547)
2025-05-19 23:28:12,398 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-05-19 23:28:12,398 - aiogram.dispatcher - WARNING - Sleep for 1.403470 seconds and try again... (tryings = 1, bot id = 7573060547)
2025-05-19 23:28:18,474 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-05-19 23:28:18,474 - aiogram.dispatcher - WARNING - Sleep for 1.989511 seconds and try again... (tryings = 2, bot id = 7573060547)
2025-05-19 23:28:25,497 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-05-19 23:28:25,497 - aiogram.dispatcher - WARNING - Sleep for 2.497594 seconds and try again... (tryings = 3, bot id = 7573060547)
2025-05-19 23:28:33,396 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-05-19 23:28:33,396 - aiogram.dispatcher - WARNING - Sleep for 3.161316 seconds and try again... (tryings = 4, bot id = 7573060547)
2025-05-19 23:28:42,566 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-05-19 23:28:42,566 - aiogram.dispatcher - WARNING - Sleep for 4.073702 seconds and try again... (tryings = 5, bot id = 7573060547)
2025-05-19 23:28:50,581 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-05-19 23:28:50,582 - aiogram.dispatcher - WARNING - Sleep for 4.942596 seconds and try again... (tryings = 6, bot id = 7573060547)
2025-05-19 23:28:57,988 - aiogram.dispatcher - INFO - Polling stopped
2025-05-19 23:28:58,253 - aiogram.dispatcher - INFO - Polling stopped for bot @platform_shop_bot id=7573060547 - 'Platform_shop_bot'
2025-05-19 23:28:58,255 - root - INFO - Bot stopped
2025-05-19 23:38:25,036 - __main__ - CRITICAL - Critical error while running bot: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode='HTML')` argument instead.
Traceback (most recent call last):
  File "C:\Users\r-keeper\Desktop\BotMax\bot.py", line 87, in main
    bot = Bot(token=config.BOT_TOKEN, parse_mode="HTML")
  File "C:\Users\r-keeper\AppData\Local\Programs\Python\Python313\Lib\site-packages\aiogram\client\bot.py", line 294, in __init__
    raise TypeError(
    ...<3 lines>...
    )
TypeError: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode='HTML')` argument instead.
2025-05-19 23:38:25,042 - root - INFO - Bot stopped gracefully
2025-05-19 23:39:04,451 - __main__ - INFO - Starting bot...
2025-05-19 23:39:04,454 - aiogram.dispatcher - INFO - Start polling
2025-05-19 23:39:04,880 - aiogram.dispatcher - INFO - Run polling for bot @platform_shop_bot id=7573060547 - 'Platform_shop_bot'
2025-05-19 23:39:05,076 - database.mongodb - INFO - Attempting to connect to MongoDB at mongodb+srv://mksimantipev228:CHD5QbOKaUwhZXj1@shopbot.ozvfezb.mongodb.net/?retryWrites=true&w=majority&appName=ShopBot
2025-05-19 23:39:09,481 - database.mongodb - INFO - Database indexes created successfully
2025-05-19 23:39:10,436 - database.mongodb - INFO - Initialized default sleep mode settings
2025-05-19 23:39:10,436 - database.mongodb - INFO - Successfully connected to MongoDB database: maxshop_db
2025-05-19 23:39:11,138 - aiogram.event - INFO - Update id=102964036 is handled. Duration 6075 ms by bot id=7573060547
2025-05-19 23:39:13,558 - aiogram.event - INFO - Update id=102964037 is handled. Duration 353 ms by bot id=7573060547
2025-05-19 23:39:15,004 - database.mongodb - INFO - [DEBUG] Getting products for category: РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ
2025-05-19 23:39:15,210 - database.mongodb - INFO - [DEBUG] Found 0 products in category РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ
2025-05-19 23:39:15,369 - aiogram.event - INFO - Update id=102964038 is handled. Duration 365 ms by bot id=7573060547
2025-05-19 23:39:20,048 - aiogram.event - INFO - Update id=102964039 is handled. Duration 568 ms by bot id=7573060547
2025-05-19 23:39:21,767 - aiogram.event - INFO - Update id=102964040 is handled. Duration 169 ms by bot id=7573060547
2025-05-19 23:39:23,461 - aiogram.event - INFO - Update id=102964041 is handled. Duration 298 ms by bot id=7573060547
2025-05-19 23:39:28,412 - aiogram.event - INFO - Update id=102964042 is handled. Duration 306 ms by bot id=7573060547
2025-05-19 23:39:29,790 - aiogram.event - INFO - Update id=102964043 is handled. Duration 308 ms by bot id=7573060547
2025-05-19 23:39:31,378 - aiogram.event - INFO - Update id=102964044 is handled. Duration 482 ms by bot id=7573060547
2025-05-19 23:39:37,571 - aiogram.event - INFO - Update id=102964045 is handled. Duration 180 ms by bot id=7573060547
2025-05-19 23:39:42,384 - handlers.admin_handlers - INFO - Successful admin login for user 531632690
2025-05-19 23:39:42,633 - aiogram.event - INFO - Update id=102964046 is handled. Duration 251 ms by bot id=7573060547
2025-05-19 23:39:44,405 - aiogram.event - INFO - Update id=102964047 is handled. Duration 277 ms by bot id=7573060547
2025-05-19 23:39:46,039 - aiogram.event - INFO - Update id=102964048 is handled. Duration 618 ms by bot id=7573060547
2025-05-19 23:39:47,472 - aiogram.event - INFO - Update id=102964049 is handled. Duration 320 ms by bot id=7573060547
2025-05-19 23:39:50,179 - aiogram.event - INFO - Update id=102964050 is handled. Duration 172 ms by bot id=7573060547
2025-05-19 23:39:52,162 - aiogram.event - INFO - Update id=102964051 is handled. Duration 167 ms by bot id=7573060547
2025-05-19 23:39:54,391 - aiogram.event - INFO - Update id=102964052 is handled. Duration 189 ms by bot id=7573060547
2025-05-19 23:39:59,637 - aiogram.event - INFO - Update id=102964053 is handled. Duration 369 ms by bot id=7573060547
2025-05-19 23:40:01,933 - aiogram.event - INFO - Update id=102964054 is handled. Duration 671 ms by bot id=7573060547
2025-05-19 23:40:04,556 - aiogram.event - INFO - Update id=102964055 is handled. Duration 519 ms by bot id=7573060547
2025-05-19 23:40:05,667 - database.mongodb - INFO - [DEBUG] Attempting to get product with ID: 682b7affb5434504b423b164
2025-05-19 23:40:05,882 - database.mongodb - INFO - [DEBUG] Found product in database: {'_id': ObjectId('682b7affb5434504b423b164'), 'name': 'Dndjdj', 'category': 'РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ 2', 'price': 48484, 'description': 'Jfjfjf', 'photo': 'AgACAgIAAxkBAAMSaCt3XR9e4CkdiVfqyED6rvsypCgAAtnyMRvJFVhJO-y7cEK3j5wBAAMCAAN5AAM2BA', 'available': True}
2025-05-19 23:40:05,883 - database.mongodb - INFO - [DEBUG] Converted product ID to string: 682b7affb5434504b423b164
2025-05-19 23:40:06,213 - aiogram.event - INFO - Update id=102964056 is handled. Duration 552 ms by bot id=7573060547
2025-05-19 23:40:07,847 - database.mongodb - INFO - [DEBUG] Attempting to get product with ID: 682b7affb5434504b423b164
2025-05-19 23:40:08,052 - database.mongodb - INFO - [DEBUG] Found product in database: {'_id': ObjectId('682b7affb5434504b423b164'), 'name': 'Dndjdj', 'category': 'РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ 2', 'price': 48484, 'description': 'Jfjfjf', 'photo': 'AgACAgIAAxkBAAMSaCt3XR9e4CkdiVfqyED6rvsypCgAAtnyMRvJFVhJO-y7cEK3j5wBAAMCAAN5AAM2BA', 'available': True}
2025-05-19 23:40:08,053 - database.mongodb - INFO - [DEBUG] Converted product ID to string: 682b7affb5434504b423b164
2025-05-19 23:40:08,392 - aiogram.event - INFO - Update id=102964057 is handled. Duration 552 ms by bot id=7573060547
2025-05-19 23:40:09,427 - database.mongodb - INFO - [DEBUG] Attempting to get product with ID: 682b7affb5434504b423b164
2025-05-19 23:40:09,633 - database.mongodb - INFO - [DEBUG] Found product in database: {'_id': ObjectId('682b7affb5434504b423b164'), 'name': 'Dndjdj', 'category': 'РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ 2', 'price': 48484, 'description': 'Jfjfjf', 'photo': 'AgACAgIAAxkBAAMSaCt3XR9e4CkdiVfqyED6rvsypCgAAtnyMRvJFVhJO-y7cEK3j5wBAAMCAAN5AAM2BA', 'available': True}
2025-05-19 23:40:09,635 - database.mongodb - INFO - [DEBUG] Converted product ID to string: 682b7affb5434504b423b164
2025-05-19 23:40:09,953 - aiogram.event - INFO - Update id=102964058 is handled. Duration 534 ms by bot id=7573060547
2025-05-19 23:40:15,969 - database.mongodb - INFO - [DEBUG] Attempting to get product with ID: 682b7affb5434504b423b164
2025-05-19 23:40:16,171 - database.mongodb - INFO - [DEBUG] Found product in database: {'_id': ObjectId('682b7affb5434504b423b164'), 'name': 'Dndjdj', 'category': 'РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ 2', 'price': 48484, 'description': 'Jfjfjf', 'photo': 'AgACAgIAAxkBAAMSaCt3XR9e4CkdiVfqyED6rvsypCgAAtnyMRvJFVhJO-y7cEK3j5wBAAMCAAN5AAM2BA', 'available': True}
2025-05-19 23:40:16,172 - database.mongodb - INFO - [DEBUG] Converted product ID to string: 682b7affb5434504b423b164
2025-05-19 23:40:16,681 - aiogram.event - INFO - Update id=102964059 is handled. Duration 718 ms by bot id=7573060547
2025-05-19 23:40:21,815 - database.mongodb - INFO - [DEBUG] Attempting to get product with ID: 682b7affb5434504b423b164
2025-05-19 23:40:22,031 - database.mongodb - INFO - [DEBUG] Found product in database: {'_id': ObjectId('682b7affb5434504b423b164'), 'name': 'Dndjdj', 'category': 'РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ 2', 'price': 48484, 'description': 'Jfjfjf', 'photo': 'AgACAgIAAxkBAAMSaCt3XR9e4CkdiVfqyED6rvsypCgAAtnyMRvJFVhJO-y7cEK3j5wBAAMCAAN5AAM2BA', 'available': True, 'flavors': [{'name': '20', 'quantity': 0}]}
2025-05-19 23:40:22,032 - database.mongodb - INFO - [DEBUG] Converted product ID to string: 682b7affb5434504b423b164
2025-05-19 23:40:22,366 - aiogram.event - INFO - Update id=102964060 is handled. Duration 558 ms by bot id=7573060547
2025-05-19 23:40:25,394 - database.mongodb - INFO - [DEBUG] Attempting to get product with ID: 682b7affb5434504b423b164
2025-05-19 23:40:25,603 - database.mongodb - INFO - [DEBUG] Found product in database: {'_id': ObjectId('682b7affb5434504b423b164'), 'name': 'Dndjdj', 'category': 'РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ 2', 'price': 48484, 'description': 'Jfjfjf', 'photo': 'AgACAgIAAxkBAAMSaCt3XR9e4CkdiVfqyED6rvsypCgAAtnyMRvJFVhJO-y7cEK3j5wBAAMCAAN5AAM2BA', 'available': True, 'flavors': [{'name': '20', 'quantity': 0}]}
2025-05-19 23:40:25,604 - database.mongodb - INFO - [DEBUG] Converted product ID to string: 682b7affb5434504b423b164
2025-05-19 23:40:26,042 - aiogram.event - INFO - Update id=102964061 is handled. Duration 653 ms by bot id=7573060547
2025-05-19 23:40:29,361 - database.mongodb - INFO - [DEBUG] Attempting to get product with ID: 682b7affb5434504b423b164
2025-05-19 23:40:29,577 - database.mongodb - INFO - [DEBUG] Found product in database: {'_id': ObjectId('682b7affb5434504b423b164'), 'name': 'Dndjdj', 'category': 'РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ 2', 'price': 48484, 'description': 'Jfjfjf', 'photo': 'AgACAgIAAxkBAAMSaCt3XR9e4CkdiVfqyED6rvsypCgAAtnyMRvJFVhJO-y7cEK3j5wBAAMCAAN5AAM2BA', 'available': True, 'flavors': [{'name': '20', 'quantity': 20}]}
2025-05-19 23:40:29,578 - database.mongodb - INFO - [DEBUG] Converted product ID to string: 682b7affb5434504b423b164
2025-05-19 23:40:30,117 - aiogram.event - INFO - Update id=102964062 is handled. Duration 762 ms by bot id=7573060547
2025-05-19 23:40:31,661 - aiogram.event - INFO - Update id=102964063 is handled. Duration 468 ms by bot id=7573060547
2025-05-19 23:40:35,628 - aiogram.event - INFO - Update id=102964064 is handled. Duration 532 ms by bot id=7573060547
2025-05-19 23:40:40,721 - aiogram.event - INFO - Update id=102964065 is handled. Duration 198 ms by bot id=7573060547
2025-05-19 23:40:44,292 - aiogram.event - INFO - Update id=102964066 is handled. Duration 195 ms by bot id=7573060547
2025-05-19 23:40:46,549 - aiogram.event - INFO - Update id=102964067 is handled. Duration 400 ms by bot id=7573060547
2025-05-19 23:40:47,737 - database.mongodb - INFO - [DEBUG] Getting products for category: РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ 2
2025-05-19 23:40:47,950 - database.mongodb - INFO - [DEBUG] Found 1 products in category РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ 2
2025-05-19 23:40:48,360 - aiogram.event - INFO - Update id=102964068 is handled. Duration 623 ms by bot id=7573060547
2025-05-19 23:40:50,162 - handlers.user_handlers - INFO - Starting select_flavor handler
2025-05-19 23:40:50,163 - database.mongodb - INFO - [DEBUG] Attempting to get product with ID: 682b7affb5434504b423b164
2025-05-19 23:40:50,377 - database.mongodb - INFO - [DEBUG] Found product in database: {'_id': ObjectId('682b7affb5434504b423b164'), 'name': 'Dndjdj', 'category': 'РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ 2', 'price': 48484, 'description': 'Jfjfjf', 'photo': 'AgACAgIAAxkBAAMSaCt3XR9e4CkdiVfqyED6rvsypCgAAtnyMRvJFVhJO-y7cEK3j5wBAAMCAAN5AAM2BA', 'available': True, 'flavors': [{'name': '20', 'quantity': 20}]}
2025-05-19 23:40:50,378 - database.mongodb - INFO - [DEBUG] Converted product ID to string: 682b7affb5434504b423b164
2025-05-19 23:40:50,825 - handlers.user_handlers - INFO - Created new user: 531632690
2025-05-19 23:40:51,497 - aiogram.event - INFO - Update id=102964069 is handled. Duration 1335 ms by bot id=7573060547
2025-05-19 23:40:54,435 - database.mongodb - INFO - [DEBUG] Attempting to get product with ID: 682b7affb5434504b423b164
2025-05-19 23:40:54,648 - database.mongodb - INFO - [DEBUG] Found product in database: {'_id': ObjectId('682b7affb5434504b423b164'), 'name': 'Dndjdj', 'category': 'РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ 2', 'price': 48484, 'description': 'Jfjfjf', 'photo': 'AgACAgIAAxkBAAMSaCt3XR9e4CkdiVfqyED6rvsypCgAAtnyMRvJFVhJO-y7cEK3j5wBAAMCAAN5AAM2BA', 'available': True, 'flavors': [{'name': '20', 'quantity': 20}]}
2025-05-19 23:40:54,649 - database.mongodb - INFO - [DEBUG] Converted product ID to string: 682b7affb5434504b423b164
2025-05-19 23:40:55,032 - aiogram.event - INFO - Update id=102964070 is handled. Duration 1018 ms by bot id=7573060547
2025-05-19 23:41:04,051 - aiogram.event - INFO - Update id=102964071 is handled. Duration 170 ms by bot id=7573060547
2025-05-19 23:41:09,724 - aiogram.event - INFO - Update id=102964072 is handled. Duration 440 ms by bot id=7573060547
2025-05-19 23:41:17,921 - database.mongodb - INFO - [DEBUG] Attempting to get product with ID: 682b7affb5434504b423b164
2025-05-19 23:41:18,133 - database.mongodb - INFO - [DEBUG] Found product in database: {'_id': ObjectId('682b7affb5434504b423b164'), 'name': 'Dndjdj', 'category': 'РўРµСЃС‚РѕРІР°СЏ РєР°С‚РµРіРѕСЂРёСЏ 2', 'price': 48484, 'description': 'Jfjfjf', 'photo': 'AgACAgIAAxkBAAMSaCt3XR9e4CkdiVfqyED6rvsypCgAAtnyMRvJFVhJO-y7cEK3j5wBAAMCAAN5AAM2BA', 'available': True, 'flavors': [{'name': '20', 'quantity': 20}]}
2025-05-19 23:41:18,134 - database.mongodb - INFO - [DEBUG] Converted product ID to string: 682b7affb5434504b423b164
2025-05-19 23:41:19,047 - aiogram.event - INFO - Update id=102964073 is handled. Duration 1552 ms by bot id=7573060547
2025-05-19 23:41:23,261 - aiogram.event - INFO - Update id=102964074 is handled. Duration 1078 ms by bot id=7573060547
2025-05-19 23:41:31,662 - aiogram.event - INFO - Update id=102964075 is handled. Duration 219 ms by bot id=7573060547
2025-05-19 23:41:35,251 - handlers.admin_handlers - INFO - Successful admin login for user 531632690
2025-05-19 23:41:35,417 - aiogram.event - INFO - Update id=102964076 is handled. Duration 168 ms by bot id=7573060547
2025-05-19 23:41:37,633 - aiogram.event - INFO - Update id=102964077 is handled. Duration 608 ms by bot id=7573060547
2025-05-19 23:41:40,199 - aiogram.event - INFO - Update id=102964078 is handled. Duration 838 ms by bot id=7573060547
2025-05-19 23:41:42,191 - aiogram.event - INFO - Update id=102964079 is handled. Duration 382 ms by bot id=7573060547
2025-05-19 23:41:44,124 - aiogram.event - INFO - Update id=102964080 is handled. Duration 643 ms by bot id=7573060547
2025-05-19 23:41:48,479 - database.mongodb - INFO - Sleep mode updated: enabled=True, end_time=10:00
2025-05-19 23:41:48,709 - aiogram.event - INFO - Update id=102964081 is handled. Duration 449 ms by bot id=7573060547
2025-05-19 23:41:53,287 - aiogram.event - INFO - Update id=102964082 is handled. Duration 188 ms by bot id=7573060547
2025-05-19 23:41:55,861 - aiogram.event - INFO - Update id=102964083 is handled. Duration 194 ms by bot id=7573060547
2025-05-19 23:42:01,011 - aiogram.event - INFO - Update id=102964084 is handled. Duration 450 ms by bot id=7573060547
2025-05-19 23:42:03,133 - aiogram.event - INFO - Update id=102964085 is handled. Duration 321 ms by bot id=7573060547
2025-05-19 23:42:12,056 - aiogram.dispatcher - INFO - Polling stopped
2025-05-19 23:42:12,315 - aiogram.dispatcher - INFO - Polling stopped for bot @platform_shop_bot id=7573060547 - 'Platform_shop_bot'
2025-05-19 23:42:12,317 - root - INFO - Bot stopped gracefully
